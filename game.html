<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SNES Matching Game</title>
    <style>
        body {
            height: 100vh;
            margin: 0;
            font-family: Arial, Helvetica, sans-serif;
            color: #211a21;
            background: #cec9cc;

            display: flex;
            flex-direction: column; /*stacks child elements vertically*/
            justify-content: center; /*aligns items across the main axis [vertical here]*/
            align-items: center; /*aligns items across the cross axis [horizontal here]*/
        }
        img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .row {
            width: 600px;
            height: 80px;
            padding: 5px;
            border: 5px solid #4f43ae;
            background: #908a99;

            display: flex;
            justify-content: space-evenly; /*aligns items across the main axis [horizontal here]*/
            align-items: center; /*aligns items across the cross axis [vertical here]*/
        }
        .item {
            /* Box art image ratios: 90:62 (most), 90:65 (Chrono Trigger, DKC2, Earthbound) */
            width: 90px;
            height: 62px;
            border: 5px solid #211a21;
            background: #b5b6e4;
        }
        .spacer {
            height: 5px;
        }
        #fill {
            width: 90px;
            height: 62px;
            background: #4f43ae;
            
            display: flex;
            justify-content: center; /*aligns items across the main axis [horizontal here]*/
            align-items: center; /*aligns items across the cross axis [vertical here]*/
        }
    </style>
</head>
<body>
    <main>
        <div class="row">
            <div class="item getsImg" onclick="handleComparison(this)"></div>
            <div class="item getsImg" onclick="handleComparison(this)"></div>
            <div class="item getsImg" onclick="handleComparison(this)"></div>
            <div class="item getsImg" onclick="handleComparison(this)"></div>
            <div class="item getsImg" onclick="handleComparison(this)"></div>
        </div>
        <div class="spacer"></div>
        <div class="row">
            <div class="item getsImg" onclick="handleComparison(this)"></div>
            <div class="item getsImg" onclick="handleComparison(this)"></div>
            <div class="item getsImg" onclick="handleComparison(this)"></div>
            <div class="item getsImg" onclick="handleComparison(this)"></div>
            <div class="item getsImg" onclick="handleComparison(this)"></div>
        </div>
        <div class="spacer"></div>
        <div class="row">
            <div class="item getsImg" onclick="handleComparison(this)"></div>
            <div class="item getsImg" onclick="handleComparison(this)"></div>
            <div class="item">
                <div id="fill" onclick="reloadPage()"></div>
            </div>
            <div class="item getsImg" onclick="handleComparison(this)"></div>
            <div class="item getsImg" onclick="handleComparison(this)"></div>
        </div>
            <div class="spacer"></div>
        <div class="row">
            <div class="item getsImg" onclick="handleComparison(this)"></div>
            <div class="item getsImg" onclick="handleComparison(this)"></div>
            <div class="item getsImg" onclick="handleComparison(this)"></div>
            <div class="item getsImg" onclick="handleComparison(this)"></div>
            <div class="item getsImg" onclick="handleComparison(this)"></div>
        </div>
            <div class="spacer"></div>
        <div class="row">
            <div class="item getsImg" onclick="handleComparison(this)"></div>
            <div class="item getsImg" onclick="handleComparison(this)"></div>
            <div class="item getsImg" onclick="handleComparison(this)"></div>
            <div class="item getsImg" onclick="handleComparison(this)"></div>
            <div class="item getsImg" onclick="handleComparison(this)"></div>
        </div>
    </main>
    <script>

        function reloadPage() {
            if (canReload) {
                window.location.reload();
            }
        }


        function toggleDisplay(imgElement) {
            if (imgElement.style.display === "none") {
                imgElement.style.display = "block";
            } else {
                imgElement.style.display = "none";
            }
        }


        function handleComparison(divEl) {
            const imgElement = divEl.querySelector("img");
            const imgSrc = imgElement.src;

            if (!matchValue1 && !matchValue2){
                matchElement1 = divEl;
                matchValue1 = imgSrc;
                console.log("First selection made.");
            } else {
                if (matchValue1 && !matchValue2){
                    matchElement2 = divEl;
                    if (matchElement1 === matchElement2){
                        console.log("Same element clicked twice. Choose another.");
                        matchElement2 = null;
                        return;}
                    matchValue2 = imgSrc;
                    console.log("Second selection made.");
                }
                if (matchValue1 && matchValue2){
                    if (matchValue1 === matchValue2){
                        correctSnd.play();
                        console.log(" ");
                        console.log("It's a match!");
                        matchElement1.onclick = null;
                        matchElement2.onclick = null;
                        matchesFound += 1;
                        if (matchesFound === matchGoal){
                            document.getElementById("fill").textContent = "Play Again?";
                            canReload = true;
                            winSnd.play();
                            console.log(" ");
                            console.log("Congratulations! You've found all matches!");
                        }
                    } else {
                        console.log("No match.");
                        let imgEl1 = matchElement1.querySelector("img");
                        let imgEl2 = matchElement2.querySelector("img");
                        setTimeout(() => {
                            toggleDisplay(imgEl1);
                            toggleDisplay(imgEl2);
                        }
                        , 1000);
                    }
                    matchElement1 = null;
                    matchValue1 = null;
                    matchElement2 = null;
                    matchValue2 = null;
                }
            }
            toggleDisplay(imgElement);
        }


        let canReload = false;

        const correctSnd = new Audio("correct.mp3"); // buffers automatically when created
        correctSnd.volume = 0.3;
        //https://pixabay.com/sound-effects/the-correct-answer-33-183620/

        const winSnd = new Audio("win.mp3"); // buffers automatically when created
        //https://pixabay.com/sound-effects/you-win-sequence-2-183949/

        let matchElement1 = null;
        let matchValue1 = null;
        let matchElement2 = null;
        let matchValue2 = null;

        let matchesFound = 0;

        const srcArray = [
            "https://upload.wikimedia.org/wikipedia/en/8/89/SuperMarioRPGSNESCoverArtUS.jpg", // Wikpedia image uploaded by IceWelder
            "https://upload.wikimedia.org/wikipedia/en/e/e4/Smetroidbox.jpg", // Wikpedia image uploaded by Neocorelight
            "https://upload.wikimedia.org/wikipedia/en/3/32/Super_Mario_World_Coverart.png", // Wikpedia image uploaded by IceWelder
            "https://upload.wikimedia.org/wikipedia/en/a/a7/Chrono_Trigger.jpg", // Wikpedia image uploaded by Veikk0.ma
            "https://upload.wikimedia.org/wikipedia/en/2/21/The_Legend_of_Zelda_A_Link_to_the_Past_SNES_Game_Cover.jpg", // Wikpedia image uploaded by NintenBOUND
            "https://upload.wikimedia.org/wikipedia/en/1/1f/EarthBound_Box.jpg", // Wikpedia image uploaded by Czar
            "https://upload.wikimedia.org/wikipedia/en/f/f1/Mega_Man_X_Coverart.png", // Wikpedia image uploaded by IceWelder
            "https://upload.wikimedia.org/wikipedia/en/1/1a/Donkey_Kong_Country_SNES_cover.png", // Wikpedia image uploaded by IceWelder
            "https://upload.wikimedia.org/wikipedia/en/3/38/Supermariokart_box.JPG", // Wikpedia image uploaded by IceWelder
            "https://upload.wikimedia.org/wikipedia/en/3/3c/Super_Mario_All_Stars_%28game_box_art%29.jpg", // Wikpedia image uploaded by DatBot
            "https://upload.wikimedia.org/wikipedia/en/c/c3/DK_Country_2.jpg", // Wikpedia image uploaded by DatBot
            "https://upload.wikimedia.org/wikipedia/en/9/9a/Yoshi%27s_Island_%28Super_Mario_World_2%29_box_art.jpg" // Wikpedia image uploaded by IceWelder
        ];
        const matchGoal = srcArray.length; // Number of unique images to match
        const srcArrayDouble = srcArray.concat(srcArray); // Duplicate the array for pairs
        const srcArrayDoubleShuffled = srcArrayDouble.sort(() => Math.random() - 0.5); // Shuffle the array

        // Assign images to elements
        const elements = document.querySelectorAll(".getsImg");
        elements.forEach((el, idx) => {
            const newChildImg = el.appendChild(document.createElement("img"));
            newChildImg.style.display = "none";
            newChildImg.src = srcArrayDoubleShuffled[idx];
        });

    </script>
</body>
</html>